services:
  openldap_svc:
    hostname: ldap.lab.lan
    # https://hub.docker.com/r/bitnami/openldap
    image: bitnami/openldap:latest
    extra_hosts:
    - dockerhost:host-gateway
    - ldap.lab.lan:192.168.1.6
    container_name: openldap_svc
    restart: unless-stopped
    ports:
    - 389:389
    - 636:636
    environment:
    - LDAP_PORT_NUMBER=389
    - LDAP_ROOT=dc=lab,dc=lan
    # cn=admin,dc=lab,dc=lan
    - LDAP_ADMIN_USERNAME=admin
    - LDAP_ADMIN_PASSWORD=password
    - LDAP_CONFIG_ADMIN_ENABLED=yes
    # cn=config,cn=config
    - LDAP_CONFIG_ADMIN_USERNAME=config
    - LDAP_CONFIG_ADMIN_PASSWORD=password
    - LDAP_USERS=user
    - LDAP_PASSWORDS=password
    volumes:
    - ./data/openldap:/bitnami/openldap
    - ./data/certs:/opt/bitnami/openldap/certs

  phpldapadmin_svc:
    image: myphpldapadmin
    container_name: phpldapadmin1_svc
    extra_hosts:
    - dockerhost:host-gateway
    - ldap.lab.lan:192.168.1.6
    restart: unless-stopped
    ports:
    - 80:80
    environment:
    - LDAP_NAME=Lab LDAP
    - LDAP_HOST=ldap.lab.lan
    - LDAP_BASE=dc=lab,dc=lan
    - LDAP_BIND_DN=cn=admin,dc=lab,dc=lan
    - LDAP_BIND_PW=password
    - LDAP_PORT=389
    #- LDAP_TLS=false
